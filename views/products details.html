<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/product-details.css">
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
  <div class="header " >
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
     <div class="logo">
          <img src="../images/Logo-removebg-preview.png" alt="Medic Tool Logo" />
        </div>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Home</a>
        </li>
         <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Services</a>
        </li> 
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">About</a>
        </li>
         <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Contact Us</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Sections
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Dentist</a></li>
            <li><a class="dropdown-item" href="#">Pediatrics</a></li>
            <li><a class="dropdown-item" href="#">Obstetrics & Gynecology</a></li>
            <li><a class="dropdown-item" href="#">Plastic Surgeon</a></li>
            <li><a class="dropdown-item" href="#">Vet</a></li>
            
          </ul>
        </li>
        <!-- <li class="nav-item">
          <a class="nav-link disabled" aria-disabled="true">Disabled</a>
        </li> -->
      </ul>
      <form class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"/>
        <button class="btn btn-outline-success" type="submit">Search</button>
      </form>
    </div>
  </div>
</nav>
   </div>
    <div class="product-details">
        <div class="container">
           <div class="img-scroll">
  <img id="productImage" src="images/اسنان/Light Cure Machine1.png" alt="">
</div>

<div class="descreption">
  <div>
    <h4 id="brandName" class="kind-prod">Light Cure Devices</h4>
    <button id="saveBtn" class="btn-save">
      <i class="fa-solid fa-bookmark"></i>
    </button>
  </div>

  <h2 id="productName" class="name-prod">Light Cure Machine</h2>

  <button id="saleBtn" class="sale">for sale</button>
  <button id="rentBtn" class="rent">for rent</button>

  <span id="productPrice" class="price">2.765 EGP</span>

  <p id="productDesc" class="desc-product">
    A device that emits light at specific wavelengths designed to prepare a composite filling material.
  </p>

  <!-- التاريخ داخل ديف بـ id -->
  <div id="rentStartDate">
    <input type="date" class="btn-style rent-btn input-date" id="startDate" />
  </div>

  <button id="addToCartBtn" class="btn-add-card btn-style">
    add to cart <i class="fa-regular fa-credit-card"></i>
  </button>

  <button id="saveProductBtn" class="btn-buy-now btn-style">
    Save <i class="fa-solid fa-cart-plus"></i>
  </button>
</div>

        </div>



        <section class="rate">
        <div class="big-star">
           <h3> <span>4.8</span> out of 5</h3>
            <ul>
                <li><i class="fa-solid fa-star"></i></li>
                <li><i class="fa-solid fa-star"></i></li>
                <li><i class="fa-solid fa-star"></i></li>
                <li><i class="fa-solid fa-star"></i></li>
                <li><i class="fa-solid fa-star"></i></li>
            </ul>
            <p>(458 Review)</p>
        </div>
        <div class="rate-stars">
            <div class="item">
                <p>5 Stars</p>
                <div class="rate1">
                    <div class="percent star5"></div>
                </div>
            </div>
            <div class="item">
                <p>4 Stars</p>
                <div class="rate1">
                    <div class="percent star4"></div>
                </div>
            </div>
            <div class="item">
                <p>3 Stars</p>
                <div class="rate1">
                    <div class="percent star3"></div>
                </div>
            </div>
            <div class="item">
                <p>2 Stars</p>
                <div class="rate1">
                    <div class="percent star2"></div>
                </div>
            </div>
            <div class="item">
                <p>1 Stars</p>
                <div class="rate1">
                    <div class="percent star1"></div>
                </div>
            </div>
        </div>
        </section>
<div class="review">
  <div>
    <h3>Reviwes</h3>
    <span class="line"></span>
  </div>
  <form id="reviewForm">
    <input type="text" id="username" placeholder="اسمك" required />
    <div class="stars" id="starRating"></div>
    <textarea id="comment" placeholder="اكتب رأيك هنا..." required></textarea>
    <button type="submit">إرسال</button>
  </form>

  <div id="reviewsContainer"></div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const starsContainer = document.getElementById("starRating");
    const reviewsContainer = document.getElementById("reviewsContainer");
    let selectedRating = 0;

    if (!starsContainer || !reviewsContainer) {
      console.error("Missing starsContainer or reviewsContainer in DOM");
      return;
    }

    starsContainer.innerHTML = [...Array(5)].map((_, i) => `<span data-rate="${5 - i}">★</span>`).join('');
    starsContainer.addEventListener("click", function (e) {
      if (e.target.dataset.rate) {
        selectedRating = e.target.dataset.rate;
        document.querySelectorAll(".stars span").forEach(span => {
          span.classList.toggle("active", span.dataset.rate <= selectedRating);
        });
      }
    });

    document.getElementById("reviewForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const currentUser = JSON.parse(localStorage.getItem("CurrentUser"));
      const name = currentUser?.name || "مستخدم";
      const role = currentUser?.role || "user";
      const comment = document.getElementById("comment").value.trim();
      if (!selectedRating || !comment || !name) return;

      const review = {
        name,
        comment,
        rating: selectedRating
      };

      const reviews = JSON.parse(localStorage.getItem("reviews") || "[]");
      reviews.push(review);
      localStorage.setItem("reviews", JSON.stringify(reviews));

      this.reset();
      selectedRating = 0;
      document.querySelectorAll(".stars span").forEach(span => span.classList.remove("active"));

      loadReviews();
    });

    function loadReviews() {
      const reviews = JSON.parse(localStorage.getItem("reviews") || "[]");
      const currentUser = JSON.parse(localStorage.getItem("CurrentUser"));
      const currentName = currentUser?.name;
      const currentRole = currentUser?.role;
      reviewsContainer.innerHTML = "";

      reviews.forEach((review, index) => {
        const reviewDiv = document.createElement("div");
        reviewDiv.className = "review";

        let buttonsHTML = "";

        if (review.name === currentName || currentRole === "super_admin") {
          buttonsHTML = `
            <div class="review-buttons">
              <button class="edit-btn">تعديل</button>
              <button class="delete-btn">حذف</button>
            </div>`;
        }

        reviewDiv.innerHTML = `
          <div class="username">${review.name}</div>
          <div class="review-stars">${'★'.repeat(review.rating)}${'☆'.repeat(5 - review.rating)}</div>
          <div class="review-text">${review.comment}</div>
          ${buttonsHTML}
        `;

        if (review.name === currentName || currentRole === "super_admin") {
          reviewDiv.querySelector(".delete-btn").addEventListener("click", () => {
            reviews.splice(index, 1);
            localStorage.setItem("reviews", JSON.stringify(reviews));
            loadReviews();
          });

          reviewDiv.querySelector(".edit-btn").addEventListener("click", () => {
            document.getElementById("comment").value = review.comment;
            selectedRating = review.rating;
            document.querySelectorAll(".stars span").forEach(span => {
              span.classList.toggle("active", span.dataset.rate <= selectedRating);
            });

            reviews.splice(index, 1);
            localStorage.setItem("reviews", JSON.stringify(reviews));
            loadReviews();
          });
        }

        reviewsContainer.appendChild(reviewDiv);
      });
    }

    loadReviews();
  });
</script>


        
<script src="/js/product_details.js"></script>

</body>
</html>